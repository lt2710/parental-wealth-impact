"上饶市",
"营口市",
"三明市",
"蚌埠市",
"丽水市",
"岳阳市",
"清远市",
"荆州市",
"泰安市",
"衢州市",
"盘锦市",
"东营市",
"南阳市",
"马鞍山市",
"南充市",
"西宁市",
"孝感市",
"齐齐哈尔市"
)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls.R', echo=TRUE)
table(charls_merged$tier_parent)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
table(charls_married$tier_4th)
table(charls_married$tier_parent)
table(charls$tier_parent)
# from https://www.36kr.com/p/1721587073025
list_tier1 <- c(
"上海市",
"北京",
"广州市",
"深圳市",
"重庆市",
"天津",
"苏州市",
"成都市",
"武汉市",
"杭州市",
"南京市",
"西安市",
"长沙市",
"沈阳市",
"青岛市",
"郑州市",
"大连市",
"东莞市",
"宁波市"
)
list_tier2 <- c(
"厦门市",
"福州市",
"无锡市",
"合肥市",
"昆明市",
"哈尔滨",
"哈尔滨市",
"济南市",
"佛山市",
"长春市",
"温州市",
"石家庄市",
"南宁市",
"常州市",
"泉州市",
"南昌市",
"贵阳市",
"太原市",
"烟台市",
"嘉兴市",
"南通市",
"金华市",
"珠海市",
"惠州市",
"徐州市",
"海口市",
"乌鲁木齐市",
"绍兴市",
"中山市",
"台州市",
"兰州市"
)
list_tier3 <- c(
"潍坊市",
"保定市",
"镇江市",
"扬州市",
"桂林市",
"唐山市",
"三亚市",
"湖州市",
"呼和浩特市",
"廊坊市",
"洛阳市",
"威海市",
"盐城市",
"临沂市",
"江门市",
"汕头市",
"泰州市",
"漳州市",
"邯郸市",
"济宁市",
"芜湖市",
"淄博市",
"银川市",
"柳州市",
"绵阳市",
"湛江市",
"鞍山市",
"赣州市",
"大庆市",
"宜昌市",
"包头市",
"咸阳市",
"秦皇岛市",
"株洲市",
"莆田市",
"吉林市",
"淮安市",
"肇庆市",
"宁德市",
"衡阳市",
"南平市",
"连云港市",
"丹东市",
"丽江市",
"揭阳市",
"延边朝鲜族自治州",
"舟山市",
"九江市",
"龙岩市",
"沧州市",
"抚顺市",
"襄阳市",
"上饶市",
"营口市",
"三明市",
"蚌埠市",
"丽水市",
"岳阳市",
"清远市",
"荆州市",
"泰安市",
"衢州市",
"盘锦市",
"东营市",
"南阳市",
"马鞍山市",
"南充市",
"西宁市",
"孝感市",
"齐齐哈尔市"
)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_education.R', echo=TRUE)
summary(charls$asset_total)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
?mice
charls_filtered_sampled_imputed = charls_to_impute %>%
mice::mice(
m = 1,
method = "mean",
maxit = 1,
seed = 999
) %>%
mice::complete(action = 1)
warnings()
View(charls_filtered_sampled_imputed)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
charls_married <- filter(charls
,married
,male
,tier_4th
)
charls_married = charls_married %>%
mutate(
diploma = case_when(
education_years %in% c(0:12) ~ "1 up to high",
education_years %in% c(15:22) ~ "2 tertiary & above",
),
diploma_spouse = case_when(
education_years_spouse %in% c(0:12) ~ "1 up to high",
education_years_spouse %in% c(15:22) ~ "2 tertiary & above",
),
income_cat = case_when(
income %in% c(0:25000) ~ "1",
income %in% c(0:40000) ~ "2",
income %in% c(75000:125000) ~ "3",
income %in% c(175000:500000) ~ "4",
)
,
# public sector manager job
job_public = job == 7
)
# eda
# ownership ---------------------------------------------------------------
charls_married %>%
tbl_cross(row = "asset_total_quant",
col = "ownership",
percent = "row",
missing = "ifany") %>%
add_p()%>%
as_tibble()%>%
write.csv(file.path("output",paste0("charls_ownership.csv")))
# marriage homogamy ------------------------------------------------
charls_married %>%
tbl_cross(row = "diploma",
col = "diploma_spouse",
percent = "cell",
missing = "ifany") %>%
add_p()%>%
as_tibble()%>%
write.csv(file.path("output",paste0("charls_homogamy.csv")))
# home value ---------------------------------------------------------------
# make data
plot_data = charls_married %>%
filter(ownership) %>%
group_by(asset_total_quant, income_cat) %>%
summarise(num = n(),
metric = median(homevalue, na.rm = T)) %>%
drop_na()
charls_married %>%
filter(ownership) %>%
group_by(asset_total_quant, income_cat) %>%
summarise(num = n(),
metric = median(homevalue, na.rm = T))
charls_married$income_cat
charls_married$asset_total_quant
charls_married %>%
filter(ownership)
charls_married$ownership
charls_married$ownership%>%table()
charls_married %>%
filter(ownership)
charls_filtered$ownership
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
list_pm_diploma = c("小学", "扫盲班", "没有受过任何教育")
list_md_diploma = c("初中")
list_hi_diploma = c("普通高中", "中专", "技校", "职业高中")
list_clg_diploma = c("大学本科正规高等教育",
"大学本科成人高等教育",
"大学专科正规高等教育",
"大学专科成人高等教育",
"硕士研究生全日制",
"硕士研究生非全日制",
"博士研究生全日制")
list_key_cpsr <- c("省直辖�兄氐阒行⊙�",
"区地级�兄氐阒行⊙�",
"县级市�刂氐阒行⊙�")
list_nonkey_cpsr <- c("乡镇街中心中小学","其他中小学")
list_key_high <- c("教育部直属高校",
"中央或国家其他部委所",
"省直辖�兴�舾咝�")
list_nonkey_high <- c("地区所属高校",
"其他全日制高校",
"非全日制高校�宕蟆钡�")
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_wealth.R', echo=TRUE)
fyrst_object %>%
mice::complete(action = 2)
fyrst_object %>%
mice::complete(action = 1)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_wealth.R', echo=TRUE)
fyrst = fyrst_object %>%
mice::complete(action = 1) %>%
mutate_at(c("key_pm_res",
"key_md_res",
"key_hi_res",
"key_clg_res"),
~na_if(.,"dropout")%>%as.logical())
# some additional variables for husband/wife matching ------------------------------------
for (var in c("age","education_years","urbanhukou","party","job","manager","ownership")){
if (var!= "ownership"){
varname_husb = paste0(var,"_husb")
fyrst[[varname_husb]] = NA
varname_wife = paste0(var,"_wife")
fyrst[[varname_wife]] = NA
}
if (var!= "age"){
varname_husb_father = paste0(var,"_husb_father")
fyrst[[varname_husb_father]] = NA
varname_wife_father = paste0(var,"_wife_father")
fyrst[[varname_wife_father]] = NA
}
for (i in 1:nrow(fyrst)){
if (var!= "ownership"){
fyrst[[varname_husb]][i] = ifelse(fyrst[["male_res"]][i] == TRUE,
fyrst[[paste0(var,"_res")]][i],
fyrst[[paste0(var,"_sps")]][i])
fyrst[[varname_wife]][i] = ifelse(fyrst[["male_res"]][i] == TRUE,
fyrst[[paste0(var,"_sps")]][i],
fyrst[[paste0(var,"_res")]][i])
}
if (var!= "age"){
fyrst[[varname_husb_father]][i] = ifelse(fyrst[["male_res"]][i] == TRUE,
fyrst[[paste0(var,"_res_father")]][i],
fyrst[[paste0(var,"_sps_father")]][i])
fyrst[[varname_wife_father]][i] = ifelse(fyrst[["male_res"]][i] == TRUE,
fyrst[[paste0(var,"_sps_father")]][i],
fyrst[[paste0(var,"_sps_father")]][i])
}
}
}
# sort variable names
main_col = c(
"pid",
names(fyrst)[str_detect(names(fyrst),"res")],
"married_res",
names(fyrst)[str_detect(names(fyrst),"res_father")],
names(fyrst)[str_detect(names(fyrst),"sps")],
names(fyrst)[str_detect(names(fyrst),"sps_father")],
names(fyrst)[str_detect(names(fyrst),"husb")],
names(fyrst)[str_detect(names(fyrst),"husb_father")],
names(fyrst)[str_detect(names(fyrst),"wife")],
names(fyrst)[str_detect(names(fyrst),"husb_father")]
)
other_col = setdiff(names(fyrst),main_col)
fyrst = fyrst %>%
select(all_of(main_col), all_of(other_col))
save(fyrst, file = "output/fyrst.RData")
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
list_pm_diploma = c("小学", "扫盲班", "没有受过任何教育")
list_md_diploma = c("初中")
list_hi_diploma = c("普通高中", "中专", "技校", "职业高中")
list_clg_diploma = c("大学本科正规高等教育",
"大学本科成人高等教育",
"大学专科正规高等教育",
"大学专科成人高等教育",
"硕士研究生全日制",
"硕士研究生非全日制",
"博士研究生全日制")
list_key_cpsr <- c("省直辖�兄氐阒行⊙�",
"区地级�兄氐阒行⊙�",
"县级市�刂氐阒行⊙�")
list_nonkey_cpsr <- c("乡镇街中心中小学","其他中小学")
list_key_high <- c("教育部直属高校",
"中央或国家其他部委所",
"省直辖�兴�舾咝�")
list_nonkey_high <- c("地区所属高校",
"其他全日制高校",
"非全日制高校�宕蟆钡�")
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/fyrst_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls.R', echo=TRUE)
# from https://www.36kr.com/p/1721587073025
list_tier1 <- c(
"上海市",
"北京",
"广州市",
"深圳市",
"重庆市",
"天津",
"苏州市",
"成都市",
"武汉市",
"杭州市",
"南京市",
"西安市",
"长沙市",
"沈阳市",
"青岛市",
"郑州市",
"大连市",
"东莞市",
"宁波市"
)
list_tier2 <- c(
"厦门市",
"福州市",
"无锡市",
"合肥市",
"昆明市",
"哈尔滨",
"哈尔滨市",
"济南市",
"佛山市",
"长春市",
"温州市",
"石家庄市",
"南宁市",
"常州市",
"泉州市",
"南昌市",
"贵阳市",
"太原市",
"烟台市",
"嘉兴市",
"南通市",
"金华市",
"珠海市",
"惠州市",
"徐州市",
"海口市",
"乌鲁木齐市",
"绍兴市",
"中山市",
"台州市",
"兰州市"
)
list_tier3 <- c(
"潍坊市",
"保定市",
"镇江市",
"扬州市",
"桂林市",
"唐山市",
"三亚市",
"湖州市",
"呼和浩特市",
"廊坊市",
"洛阳市",
"威海市",
"盐城市",
"临沂市",
"江门市",
"汕头市",
"泰州市",
"漳州市",
"邯郸市",
"济宁市",
"芜湖市",
"淄博市",
"银川市",
"柳州市",
"绵阳市",
"湛江市",
"鞍山市",
"赣州市",
"大庆市",
"宜昌市",
"包头市",
"咸阳市",
"秦皇岛市",
"株洲市",
"莆田市",
"吉林市",
"淮安市",
"肇庆市",
"宁德市",
"衡阳市",
"南平市",
"连云港市",
"丹东市",
"丽江市",
"揭阳市",
"延边朝鲜族自治州",
"舟山市",
"九江市",
"龙岩市",
"沧州市",
"抚顺市",
"襄阳市",
"上饶市",
"营口市",
"三明市",
"蚌埠市",
"丽水市",
"岳阳市",
"清远市",
"荆州市",
"泰安市",
"衢州市",
"盘锦市",
"东营市",
"南阳市",
"马鞍山市",
"南充市",
"西宁市",
"孝感市",
"齐齐哈尔市"
)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_modeling_setup.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_education.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
source('C:/Users/Tianl/OneDrive/Documents/GitHub/parental-wealth-impact/charls_wealth.R', echo=TRUE)
